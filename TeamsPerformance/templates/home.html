<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sport Selector</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
body {
    font-family: Arial, sans-serif;
    color: #fff; /* White text */
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, #3d3d3d 0%,#000000 50%,#3d3d3d 100%);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }
.body_light {
    background: linear-gradient(135deg, #f5f5f5 0%, #e1e1e1 50%,#f5f5f5 100%);
    color: #000;
}
.body_dark {
    background: linear-gradient(135deg, #3d3d3d 0%,#000000 50%,#3d3d3d 100%);
}
.container {
    display: flex;
    justify-content: space-between; /* Space items evenly */
    align-items: flex-start; /* Align items to the top */
    background-color: rgba(255, 255, 255, 0.1); /* Semi-transparent white background */
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Add shadow */
    width: 90%; /* Set the width of the container */
    max-width: 1200px; /* Maximum width of the container */
    margin: 0 auto; /* Center the container horizontally */
  }

  .card {
    flex: 1; /* Take up equal space */
    padding: 20px;
    margin: 10px;
    background-color: rgba(255, 255, 255, 0.2); /* Lighter semi-transparent white */
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Add slight shadow */
    width: 30%; /* Set the width of each card */
  }

  .inner-card {
    margin: 10px 0;
    padding: 10px;
    background-color: rgba(255, 255, 255, 0.1); /* Lighter semi-transparent white */
    border-radius: 5px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Add slight shadow */
    transition: transform 0.3s ease;
      text-align: center;
      min-height: 100px;
  }

  .inner-card:hover {
    transform: scale(1.05); /* Scale up on hover */
  }

  .dropdown-wrapper,
  .select-wrapper {
    margin-bottom: 20px;
  }

  .options {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }

  .myForm {
      min-width: 80%;
  }

  .option {
    padding: 15px 25px; /* Increased padding for longer content */
    margin: 5px;
    border-radius: 20px;
    font-size: 16px;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.3s ease, border 0.3s ease; /* Added border transition */
    background-color: rgba(255, 255, 0, 0.7); /* Lighter yellow background */
    color: #000; /* Black text */
  }

  .option.selected {
    background-color: rgba(255, 255, 0, 0.7); /* Lighter yellow background when selected */
    border: 2px solid #fff; /* White border when selected */
    color: #000; /* Black text when selected */
  }

  .option:hover {
    opacity: 0.7;
  }

  select {
    padding: 10px;
    border-radius: 5px;
    font-size: 16px;
    margin-bottom: 10px;
    width: 100%; /* Make the select element full width */
  }
  .title {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 10px;
    text-align: center;
  }

  .toggle-button {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 50px;
            height: 50px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            perspective: 1000px;
        }
        .toggle-button .card2 {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .toggle-button.dark .card2 {
            transform: rotateY(180deg);
        }
        .toggle-button .card2 .icon {
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            font-size: 24px;
        }
        .toggle-button .card2 .sun-icon {
            background-color: transparent;
            color: black;
        }
        .toggle-button .card2 .moon-icon {
            background-color: transparent;
            color: white;
            transform: rotateY(180deg);
        }
</style>
</head>
<body>
    <button class="toggle-button" id="toggleButton">
        <div class="card2">
            <div class="icon moon-icon"><i class="fas fa-moon"></i></div>
            <div class="icon sun-icon"><i class="fas fa-sun"></i></div>
        </div>
    </button>
<form method="POST" id="myForm" class="myForm">
    {% csrf_token %}
    <div class="container">
  <div class="card" id="recently_called">
    <div class="title">Most Recent</div>

    </div>


  <div class="card">
    <div class="title">Search Box</div>

    <div class="select-wrapper">
     <input type="hidden" name="sports" id="pass_sports">
      <div id="sports" class="options">
{#      <select name="sports" id="pass_sports" style="display: none;"></select>#}
{#        <div class="option" onclick="toggleSelected(this)">Football</div>#}
{#        <div class="option" onclick="toggleSelected(this)">Basketball</div>#}
        <!-- Add more sport options as needed -->
      </div>
    </div>

  <div class="select-wrapper">
     <input type="hidden" name="is_dark" id="is_dark">
      <div id="is_dark" class="options">
{#      <select name="sports" id="pass_sports" style="display: none;"></select>#}
{#        <div class="option" onclick="toggleSelected(this)">Football</div>#}
{#        <div class="option" onclick="toggleSelected(this)">Basketball</div>#}
        <!-- Add more sport options as needed -->
      </div>
    </div>

    <div class="dropdown-wrapper">
      <select id="season" name="season">
      </select>
    </div>

    <div class="select-wrapper">
      <select name="leagues" id="leagues">
        <option value="none">Choose League</option>
      </select>
    </div>

    <div class="select-wrapper">
      <select name="team_name" id="team_name" style="pointer-events: none; opacity: 0.5">
      </select>
    </div>

    <div class="select-wrapper">
        <div class="options">
          <button id="calculate_button" class="option" type="submit" onclick="set_G_vars_on_click()" style="pointer-events: none; opacity: 0.5" >Search</button>
        </div>
    </div>

</div>

  <div class="card" id="most_popular">
    <div class="title">Most Popular</div>
    </div>
  </div>
</div>
</form>
<script>

    const body = document.body;
    const DEFAULT_SEASON = "23-24"
    const DEFAULT_SPORT = "Football"
    let leagues_info = {{ leagues_info|safe }};
    let most_popular = leagues_info["MostPopular"]
    let sports = leagues_info["sports"];
    let sportsOptions = document.getElementById("sports");
    let G_sport = DEFAULT_SPORT;
    let G_is_dark = {{ is_dark |safe }};
    let recently_called = {{ recently_called|safe }};

    //const body = document.body;

    const toggleButton = document.getElementById('toggleButton');
    if(G_is_dark){
        toggleButton.classList.toggle('dark');
    }else {
        body.classList.toggle("body_light");
    }

    toggleButton.addEventListener('click', function() {
            G_is_dark = 1- G_is_dark;
            //body.classList.toggle("body_dark");
            body.classList.toggle("body_light")
            //body.classList.remove("body_light")
            toggleButton.classList.toggle('dark');
        {#toggleButton.classList.toggle('light');#}
    });

    let most_popular_card = document.getElementById("most_popular");
    for (let i=0 ; i < most_popular.length; i++) {
        let inner_card = document.createElement('div');
        const header = document.createElement('h3');
        header.innerHTML = most_popular[i][3];
        const info = document.createElement('p');
        info.innerHTML = most_popular[i][2] + " • " + most_popular[i][1];
        inner_card.appendChild(header);
        inner_card.appendChild(info);
        inner_card.classList.add("inner-card");
        inner_card.addEventListener('click', () => {
            inner_cards_on_click(most_popular[i])
        });
        most_popular_card.appendChild(inner_card);

    }

    let recently_called_card = document.getElementById("recently_called");
    for (let i=0 ; i < recently_called.length; i++) {
        let inner_card = document.createElement('div');
        const header = document.createElement('h3');
            header.innerHTML = recently_called[i][3];
            const info = document.createElement('p');
            info.innerHTML = recently_called[i][2] + " • " + recently_called[i][1];
        if(recently_called[i][3] === "None"){
            header.innerHTML = " ";
            {#const info = document.createElement('p');#}
            info.innerHTML = " ";
            inner_card.style = "pointer-events: none; opacity: 0.5";
        }
        inner_card.appendChild(header);
        inner_card.appendChild(info);
        inner_card.classList.add("inner-card");
        inner_card.addEventListener('click', () => {
            inner_cards_on_click(recently_called[i])
        });
        recently_called_card.appendChild(inner_card);

    }

    for (const sport in sports) {
        const newItem = document.createElement('div');
        newItem.classList.add('option');
        newItem.textContent = sport;
        newItem.id = sport;
        sportsOptions.appendChild(newItem);
        if(sport === DEFAULT_SPORT)
            newItem.classList.add('selected');

        newItem.addEventListener('click', () => {
        {#alert(`You clicked: ${sport}`);#}
        const allOptions = document.querySelectorAll('.option');
        allOptions.forEach(opt => opt.classList.remove('selected'));
        newItem.classList.add('selected');
        sport_listener(sport);
        // You can do further processing here, such as updating another div with the selected value
        });
    }

     function sport_listener(sport){
        G_sport = sport;

        console.log("passs sport ",pass_sports.value, "-",sport);
        let seasonsDropdown = document.getElementById('season')
        let leaguesDropdown = document.getElementById('leagues');
        let teamNameDropdown = document.getElementById('team_name');
        let calculateButton = document.getElementById('calculate_button');

        teamNameDropdown.innerHTML = "";
        leaguesDropdown.innerHTML = '<option value="none">Choose League</option>';
        seasonsDropdown.innerHTML = "";
        seasonsDropdown.value = DEFAULT_SEASON;
        seasonsDropdown.text = DEFAULT_SEASON;

        for (const season in sports[sport]) {
            console.log(season);
            var option = document.createElement('option');
            option.value = season;
            option.text = season;
            seasonsDropdown.appendChild(option);
        }
        for (const league in sports[sport][DEFAULT_SEASON].leagues) {
                var option = document.createElement('option');
                option.value = league;
                option.text = league;
                leaguesDropdown.appendChild(option);
         }

         teamNameDropdown.style="pointer-events: none; opacity: 0.5";
         calculateButton.style="pointer-events: none; opacity: 0.5";
    }


    let seasonsDropdown = document.getElementById('season')
    let leaguesDropdown = document.getElementById('leagues');
    for (const season in sports[DEFAULT_SPORT]) {
            console.log(season);
            var option = document.createElement('option');
            option.value = season;
            option.text = season;
            seasonsDropdown.appendChild(option);
    }
    leaguesDropdown.innerHTML = '<option value="none">Choose League</option>'
     for (const league in sports[DEFAULT_SPORT][DEFAULT_SEASON].leagues) {
            var option = document.createElement('option');
            option.value = league;
            option.text = league;
            leaguesDropdown.appendChild(option);
        }



document.getElementById("season").addEventListener("change", function () {
    let sport = G_sport ;//sportsDropdown.value; Todo :: FIXME
    let season = document.getElementById('season').value;
    let leaguesDropdown = document.getElementById('leagues');
    let teamNameDropdown = document.getElementById('team_name');
    let calculateButton = document.getElementById('calculate_button');

    if (season !== "none") {
        leaguesDropdown.style = "";
        leaguesDropdown.innerHTML = '<option value="none">Choose League</option>';

        for (const league in sports[sport][season].leagues) {
            var option = document.createElement('option');
            option.value = league;
            option.text = league;
            leaguesDropdown.appendChild(option);
        }
    }
    teamNameDropdown.style="pointer-events: none; opacity: 0.5";
    calculateButton.style="pointer-events: none; opacity: 0.5";
    teamNameDropdown.innerHTML = "";

});

document.getElementById("leagues").addEventListener("change", function() {

    let sport = G_sport//sportsDropdown.value; todo :: fixme
    let season = document.getElementById('season').value;
    let league = document.getElementById('leagues').value;
    let teamNameDropdown = document.getElementById('team_name');
    let calculateButton = document.getElementById('calculate_button');
    teamNameDropdown.innerHTML = "";

    if (league === "none") {
        teamNameDropdown.style="pointer-events: none; opacity: 0.5";
        calculateButton.style="pointer-events: none; opacity: 0.5";
        return;
    }

    calculateButton.style = "";
    teamNameDropdown.style = "";

    let teamsInLeagues = sports[sport][season].leagues[league].teams;

    for (var i = 0; i < teamsInLeagues.length; i++) {
        var option = document.createElement('option');
        option.value = teamsInLeagues[i];
        option.text = teamsInLeagues[i];
        teamNameDropdown.appendChild(option);
    }
});


  function set_G_vars_on_click() {
    document.getElementById('pass_sports').value = G_sport;
    document.getElementById('is_dark').value = G_is_dark;

  }

  function inner_cards_on_click(vars){
    const form = document.getElementById("myForm")
      document.getElementById("pass_sports").value = vars[0];
        document.getElementById('is_dark').value = G_is_dark;
      sport_listener(vars[0]);


    ids = {1: "season",2: "leagues", 3: "team_name"}
      var option = document.createElement('option');
      for(id in ids){
          option.value = vars[id];
          option.text = vars[id];
          document.getElementById(ids[id]).appendChild(option);
          document.getElementById(ids[id]).value = vars[id];
      }
    form.submit()
  }
</script>

</body>
</html>